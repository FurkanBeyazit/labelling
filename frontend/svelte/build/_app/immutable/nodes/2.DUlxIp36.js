import{C as xe,s as je,n as _e,d as v,Q as Ne,i as le,q as f,c as h,e as w,h as _,R as He,a as me,S as he,b as o,p as fe,f as K,g as R,r as se,t as Q,j as z,T as Je,U as Ae,V as we,K as vt,x as _t,W as mt,X as pt,Y as bt,Z as gt,_ as wt,B as Ge}from"../chunks/D4RsQkJ3.js";import{a as ke,S as Pe,i as Oe,d as Be,t as Te,c as Ke,m as Ue,e as Re,b as ze,g as Qe}from"../chunks/6bsJOLjt.js";function Ce(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function Ct(s,e){s.d(1),e.delete(s.key)}function kt(s,e,t,l,n,a,i,c,r,D,m,p){let E=s.length,V=a.length,F=E;const j={};for(;F--;)j[s[F].key]=F;const N=[],y=new Map,b=new Map,k=[];for(F=V;F--;){const u=p(n,a,F),T=t(u);let g=i.get(T);g?k.push(()=>g.p(u,e)):(g=D(T,u),g.c()),y.set(T,N[F]=g),T in j&&b.set(T,Math.abs(F-j[T]))}const q=new Set,W=new Set;function x(u){ke(u,1),u.m(c,m),i.set(u.key,u),m=u.first,V--}for(;E&&V;){const u=N[V-1],T=s[E-1],g=u.key,X=T.key;u===T?(m=u.first,E--,V--):y.has(X)?!i.has(g)||q.has(g)?x(u):W.has(X)?E--:b.get(g)>b.get(X)?(W.add(g),x(u)):(q.add(X),E--):(r(T,i),E--)}for(;E--;){const u=s[E];y.has(u.key)||r(u,i)}for(;V;)x(N[V-1]);return xe(k),N}function Ze(s,e,t){const l=s.slice();return l[8]=e[t],l}function $e(s){let e,t="No videos uploaded";return{c(){e=_("p"),e.textContent=t,this.h()},l(l){e=h(l,"P",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-gblcz6"&&(e.textContent=t),this.h()},h(){f(e,"class","text-center text-base-content/50 py-4")},m(l,n){le(l,e,n)},p:_e,d(l){l&&v(e)}}}function et(s){let e,t=s[8].approved_count+"",l,n;return{c(){e=_("span"),l=Q(t),n=Q(" labeled"),this.h()},l(a){e=h(a,"SPAN",{class:!0});var i=w(e);l=K(i,t),n=K(i," labeled"),i.forEach(v),this.h()},h(){f(e,"class","badge badge-sm badge-success")},m(a,i){le(a,e,i),o(e,l),o(e,n)},p(a,i){i&1&&t!==(t=a[8].approved_count+"")&&me(l,t)},d(a){a&&v(e)}}}function tt(s){let e,t=s[8].pending_count+"",l,n;return{c(){e=_("span"),l=Q(t),n=Q(" pending"),this.h()},l(a){e=h(a,"SPAN",{class:!0});var i=w(e);l=K(i,t),n=K(i," pending"),i.forEach(v),this.h()},h(){f(e,"class","badge badge-sm badge-warning")},m(a,i){le(a,e,i),o(e,l),o(e,n)},p(a,i){i&1&&t!==(t=a[8].pending_count+"")&&me(l,t)},d(a){a&&v(e)}}}function lt(s){let e,t,l,n,a,i=s[8].filename+"",c,r,D,m,p,E=s[8].frames_count+"",V,F,j,N,y,b,k='<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>',q,W,x,u=s[8].approved_count>0&&et(s),T=s[8].pending_count>0&&tt(s);function g(...P){return s[4](s[8],...P)}function X(){return s[5](s[8])}function ee(...P){return s[6](s[8],...P)}return{c(){e=_("div"),t=_("div"),l=_("div"),n=_("div"),a=_("h3"),c=Q(i),D=z(),m=_("div"),p=_("span"),V=Q(E),F=Q(" frames"),j=z(),u&&u.c(),N=z(),T&&T.c(),y=z(),b=_("button"),b.innerHTML=k,q=z(),this.h()},l(P){e=h(P,"DIV",{class:!0,role:!0,tabindex:!0});var I=w(e);t=h(I,"DIV",{class:!0});var B=w(t);l=h(B,"DIV",{class:!0});var J=w(l);n=h(J,"DIV",{class:!0});var S=w(n);a=h(S,"H3",{class:!0,title:!0});var O=w(a);c=K(O,i),O.forEach(v),D=R(S),m=h(S,"DIV",{class:!0});var A=w(m);p=h(A,"SPAN",{class:!0});var te=w(p);V=K(te,E),F=K(te," frames"),te.forEach(v),j=R(A),u&&u.l(A),N=R(A),T&&T.l(A),A.forEach(v),S.forEach(v),y=R(J),b=h(J,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),se(b)!=="svelte-49snm3"&&(b.innerHTML=k),J.forEach(v),B.forEach(v),q=R(I),I.forEach(v),this.h()},h(){var P,I;f(a,"class","font-medium text-sm truncate"),f(a,"title",r=s[8].filename),f(p,"class","badge badge-sm badge-ghost"),f(m,"class","flex gap-2 mt-1"),f(n,"class","flex-1 min-w-0"),f(b,"class","btn btn-ghost btn-xs btn-square text-error"),f(b,"title","Delete video"),f(l,"class","flex justify-between items-start"),f(t,"class","card-body p-3"),f(e,"class","card bg-base-100 cursor-pointer hover:bg-base-300 transition-colors"),f(e,"role","button"),f(e,"tabindex","0"),he(e,"ring-2",((P=s[1])==null?void 0:P.video_id)===s[8].video_id),he(e,"ring-primary",((I=s[1])==null?void 0:I.video_id)===s[8].video_id)},m(P,I){le(P,e,I),o(e,t),o(t,l),o(l,n),o(n,a),o(a,c),o(n,D),o(n,m),o(m,p),o(p,V),o(p,F),o(m,j),u&&u.m(m,null),o(m,N),T&&T.m(m,null),o(l,y),o(l,b),o(e,q),W||(x=[fe(b,"click",g),fe(e,"click",X),fe(e,"keypress",ee)],W=!0)},p(P,I){var B,J;s=P,I&1&&i!==(i=s[8].filename+"")&&me(c,i),I&1&&r!==(r=s[8].filename)&&f(a,"title",r),I&1&&E!==(E=s[8].frames_count+"")&&me(V,E),s[8].approved_count>0?u?u.p(s,I):(u=et(s),u.c(),u.m(m,N)):u&&(u.d(1),u=null),s[8].pending_count>0?T?T.p(s,I):(T=tt(s),T.c(),T.m(m,null)):T&&(T.d(1),T=null),I&3&&he(e,"ring-2",((B=s[1])==null?void 0:B.video_id)===s[8].video_id),I&3&&he(e,"ring-primary",((J=s[1])==null?void 0:J.video_id)===s[8].video_id)},d(P){P&&v(e),u&&u.d(),T&&T.d(),W=!1,xe(x)}}}function Et(s){let e,t=Ce(s[0]),l=[];for(let a=0;a<t.length;a+=1)l[a]=lt(Ze(s,t,a));let n=null;return t.length||(n=$e()),{c(){e=_("div");for(let a=0;a<l.length;a+=1)l[a].c();n&&n.c(),this.h()},l(a){e=h(a,"DIV",{class:!0});var i=w(e);for(let c=0;c<l.length;c+=1)l[c].l(i);n&&n.l(i),i.forEach(v),this.h()},h(){f(e,"class","space-y-2")},m(a,i){le(a,e,i);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(e,null);n&&n.m(e,null)},p(a,[i]){if(i&15){t=Ce(a[0]);let c;for(c=0;c<t.length;c+=1){const r=Ze(a,t,c);l[c]?l[c].p(r,i):(l[c]=lt(r),l[c].c(),l[c].m(e,null))}for(;c<l.length;c+=1)l[c].d(1);l.length=t.length,!t.length&&n?n.p(a,i):t.length?n&&(n.d(1),n=null):(n=$e(),n.c(),n.m(e,null))}},i:_e,o:_e,d(a){a&&v(e),Ne(l,a),n&&n.d()}}}function yt(s,e,t){let{videos:l=[]}=e,{selectedVideo:n=null}=e;const a=He();function i(p){a("select",p)}async function c(p,E){if(E.stopPropagation(),!!confirm(`Delete "${p.filename}"?

This will also delete ${p.frames_count} frames and ${p.approved_count} labels.`))try{await fetch(`/api/videos/${p.video_id}`,{method:"DELETE"}),a("refresh")}catch(V){console.error("Delete failed:",V)}}const r=(p,E)=>c(p,E),D=p=>i(p),m=(p,E)=>E.key==="Enter"&&i(p);return s.$$set=p=>{"videos"in p&&t(0,l=p.videos),"selectedVideo"in p&&t(1,n=p.selectedVideo)},[l,n,i,c,r,D,m]}class Dt extends Pe{constructor(e){super(),Oe(this,e,yt,Et,je,{videos:0,selectedVideo:1})}}function st(s,e,t){const l=s.slice();return l[7]=e[t],l}function nt(s){let e,t=`No frames extracted
    `;return{c(){e=_("p"),e.textContent=t,this.h()},l(l){e=h(l,"P",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-1ofhpom"&&(e.textContent=t),this.h()},h(){f(e,"class","col-span-2 text-center text-base-content/50 py-4")},m(l,n){le(l,e,n)},p:_e,d(l){l&&v(e)}}}function Tt(s){let e,t="Pending";return{c(){e=_("span"),e.textContent=t,this.h()},l(l){e=h(l,"SPAN",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-1x25i2q"&&(e.textContent=t),this.h()},h(){f(e,"class","badge badge-warning badge-xs")},m(l,n){le(l,e,n)},d(l){l&&v(e)}}}function It(s){let e,t="Labeled";return{c(){e=_("span"),e.textContent=t,this.h()},l(l){e=h(l,"SPAN",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-1phew4h"&&(e.textContent=t),this.h()},h(){f(e,"class","badge badge-success badge-xs")},m(l,n){le(l,e,n)},d(l){l&&v(e)}}}function at(s){let e,t,l,n,a,i,c,r,D,m=s[7].frame_number+"",p,E,V,F,j,N;function y(x,u){return x[7].has_label?It:Tt}let b=y(s),k=b(s);function q(){return s[4](s[7])}function W(...x){return s[5](s[7],...x)}return{c(){e=_("div"),t=_("img"),a=z(),i=_("div"),k.c(),c=z(),r=_("div"),D=Q("Frame "),p=Q(m),E=z(),V=_("div"),F=z(),this.h()},l(x){e=h(x,"DIV",{class:!0,role:!0,tabindex:!0});var u=w(e);t=h(u,"IMG",{src:!0,alt:!0,class:!0,loading:!0}),a=R(u),i=h(u,"DIV",{class:!0});var T=w(i);k.l(T),T.forEach(v),c=R(u),r=h(u,"DIV",{class:!0});var g=w(r);D=K(g,"Frame "),p=K(g,m),g.forEach(v),E=R(u),V=h(u,"DIV",{class:!0}),w(V).forEach(v),F=R(u),u.forEach(v),this.h()},h(){var x,u;Je(t.src,l="/api/frames/"+s[2]+"/"+s[7].frame_id+"/image")||f(t,"src",l),f(t,"alt",n="Frame "+s[7].frame_number),f(t,"class","w-full aspect-video object-cover bg-base-300"),f(t,"loading","lazy"),f(i,"class","absolute top-1 right-1"),f(r,"class","absolute bottom-0 left-0 right-0 bg-black/50 text-white text-xs px-2 py-1"),f(V,"class","absolute inset-0 bg-primary/20 opacity-0 group-hover:opacity-100 transition-opacity"),f(e,"class","relative cursor-pointer group rounded-lg overflow-hidden"),f(e,"role","button"),f(e,"tabindex","0"),he(e,"ring-2",((x=s[1])==null?void 0:x.frame_id)===s[7].frame_id),he(e,"ring-primary",((u=s[1])==null?void 0:u.frame_id)===s[7].frame_id)},m(x,u){le(x,e,u),o(e,t),o(e,a),o(e,i),k.m(i,null),o(e,c),o(e,r),o(r,D),o(r,p),o(e,E),o(e,V),o(e,F),j||(N=[fe(e,"click",q),fe(e,"keypress",W)],j=!0)},p(x,u){var T,g;s=x,u&5&&!Je(t.src,l="/api/frames/"+s[2]+"/"+s[7].frame_id+"/image")&&f(t,"src",l),u&1&&n!==(n="Frame "+s[7].frame_number)&&f(t,"alt",n),b!==(b=y(s))&&(k.d(1),k=b(s),k&&(k.c(),k.m(i,null))),u&1&&m!==(m=s[7].frame_number+"")&&me(p,m),u&3&&he(e,"ring-2",((T=s[1])==null?void 0:T.frame_id)===s[7].frame_id),u&3&&he(e,"ring-primary",((g=s[1])==null?void 0:g.frame_id)===s[7].frame_id)},d(x){x&&v(e),k.d(),j=!1,xe(N)}}}function Vt(s){let e,t=Ce(s[0]),l=[];for(let a=0;a<t.length;a+=1)l[a]=at(st(s,t,a));let n=null;return t.length||(n=nt()),{c(){e=_("div");for(let a=0;a<l.length;a+=1)l[a].c();n&&n.c(),this.h()},l(a){e=h(a,"DIV",{class:!0});var i=w(e);for(let c=0;c<l.length;c+=1)l[c].l(i);n&&n.l(i),i.forEach(v),this.h()},h(){f(e,"class","grid grid-cols-2 gap-2")},m(a,i){le(a,e,i);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(e,null);n&&n.m(e,null)},p(a,[i]){if(i&15){t=Ce(a[0]);let c;for(c=0;c<t.length;c+=1){const r=st(a,t,c);l[c]?l[c].p(r,i):(l[c]=at(r),l[c].c(),l[c].m(e,null))}for(;c<l.length;c+=1)l[c].d(1);l.length=t.length,!t.length&&n?n.p(a,i):t.length?n&&(n.d(1),n=null):(n=nt(),n.c(),n.m(e,null))}},i:_e,o:_e,d(a){a&&v(e),Ne(l,a),n&&n.d()}}}function xt(s,e,t){let{frames:l=[]}=e,{selectedFrame:n=null}=e,{videoId:a=""}=e;const i=He();function c(m){i("select",m)}const r=m=>c(m),D=(m,p)=>p.key==="Enter"&&c(m);return s.$$set=m=>{"frames"in m&&t(0,l=m.frames),"selectedFrame"in m&&t(1,n=m.selectedFrame),"videoId"in m&&t(2,a=m.videoId)},[l,n,a,c,r,D]}class Ft extends Pe{constructor(e){super(),Oe(this,e,xt,Vt,je,{frames:0,selectedFrame:1,videoId:2})}}function ot(s,e,t){const l=s.slice();return l[42]=e[t],l[44]=t,l}function rt(s,e,t){const l=s.slice();return l[45]=e[t],l}function it(s,e,t){const l=s.slice();return l[45]=e[t],l}function ct(s){let e,t=s[45].class_name+"",l,n;return{c(){e=_("option"),l=Q(t),this.h()},l(a){e=h(a,"OPTION",{});var i=w(e);l=K(i,t),i.forEach(v),this.h()},h(){e.__value=n=s[45].class_id,we(e,e.__value)},m(a,i){le(a,e,i),o(e,l)},p(a,i){i[0]&4&&t!==(t=a[45].class_name+"")&&me(l,t),i[0]&4&&n!==(n=a[45].class_id)&&(e.__value=n,we(e,e.__value))},d(a){a&&v(e)}}}function dt(s){let e,t='<td colspan="5" class="text-center opacity-50 py-6">No labels. Draw boxes or click Auto Label.</td> ';return{c(){e=_("tr"),e.innerHTML=t},l(l){e=h(l,"TR",{"data-svelte-h":!0}),se(e)!=="svelte-1dukwmb"&&(e.innerHTML=t)},m(l,n){le(l,e,n)},p:_e,d(l){l&&v(e)}}}function ft(s){let e,t=s[45].class_name+"",l,n;return{c(){e=_("option"),l=Q(t),this.h()},l(a){e=h(a,"OPTION",{});var i=w(e);l=K(i,t),i.forEach(v),this.h()},h(){e.__value=n=s[45].class_id,we(e,e.__value)},m(a,i){le(a,e,i),o(e,l)},p(a,i){i[0]&4&&t!==(t=a[45].class_name+"")&&me(l,t),i[0]&4&&n!==(n=a[45].class_id)&&(e.__value=n,we(e,e.__value))},d(a){a&&v(e)}}}function St(s){let e,t="-";return{c(){e=_("span"),e.textContent=t,this.h()},l(l){e=h(l,"SPAN",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-umsp1d"&&(e.textContent=t),this.h()},h(){f(e,"class","opacity-50")},m(l,n){le(l,e,n)},p:_e,d(l){l&&v(e)}}}function At(s){let e,t=Math.round(s[42].confidence*100)+"",l,n;return{c(){e=_("span"),l=Q(t),n=Q("%"),this.h()},l(a){e=h(a,"SPAN",{class:!0});var i=w(e);l=K(i,t),n=K(i,"%"),i.forEach(v),this.h()},h(){f(e,"class","badge badge-sm badge-ghost")},m(a,i){le(a,e,i),o(e,l),o(e,n)},p(a,i){i[0]&64&&t!==(t=Math.round(a[42].confidence*100)+"")&&me(l,t)},d(a){a&&v(e)}}}function ut(s,e){let t,l,n=e[44]+1+"",a,i,c,r,D,m,p,E,V,F,j=(e[42].source||"manual")+"",N,y,b,k,q="Delete",W,x,u,T=Ce(e[2]),g=[];for(let S=0;S<T.length;S+=1)g[S]=ft(rt(e,T,S));function X(...S){return e[22](e[42],...S)}function ee(S,O){return S[42].confidence?At:St}let P=ee(e),I=P(e);function B(...S){return e[23](e[42],...S)}function J(){return e[24](e[42])}return{key:s,first:null,c(){t=_("tr"),l=_("td"),a=Q(n),i=z(),c=_("td"),r=_("select");for(let S=0;S<g.length;S+=1)g[S].c();m=z(),p=_("td"),I.c(),E=z(),V=_("td"),F=_("span"),N=Q(j),y=z(),b=_("td"),k=_("button"),k.textContent=q,W=z(),this.h()},l(S){t=h(S,"TR",{class:!0});var O=w(t);l=h(O,"TD",{});var A=w(l);a=K(A,n),A.forEach(v),i=R(O),c=h(O,"TD",{});var te=w(c);r=h(te,"SELECT",{class:!0});var ie=w(r);for(let ae=0;ae<g.length;ae+=1)g[ae].l(ie);ie.forEach(v),te.forEach(v),m=R(O),p=h(O,"TD",{});var ne=w(p);I.l(ne),ne.forEach(v),E=R(O),V=h(O,"TD",{});var re=w(V);F=h(re,"SPAN",{class:!0});var U=w(F);N=K(U,j),U.forEach(v),re.forEach(v),y=R(O),b=h(O,"TD",{});var Y=w(b);k=h(Y,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),se(k)!=="svelte-k3tdv0"&&(k.textContent=q),Y.forEach(v),W=R(O),O.forEach(v),this.h()},h(){f(r,"class","select select-xs select-bordered w-full max-w-[120px]"),f(F,"class","badge badge-xs"),he(F,"badge-info",e[42].source==="auto"),he(F,"badge-ghost",e[42].source!=="auto"),f(k,"class","btn btn-ghost btn-xs text-error"),f(k,"title","Delete this label"),f(t,"class","cursor-pointer hover:bg-base-200"),he(t,"bg-primary",e[5]===e[42].rect),he(t,"bg-opacity-20",e[5]===e[42].rect),this.first=t},m(S,O){le(S,t,O),o(t,l),o(l,a),o(t,i),o(t,c),o(c,r);for(let A=0;A<g.length;A+=1)g[A]&&g[A].m(r,null);Ae(r,e[42].class_id),o(t,m),o(t,p),I.m(p,null),o(t,E),o(t,V),o(V,F),o(F,N),o(t,y),o(t,b),o(b,k),o(t,W),x||(u=[fe(r,"change",X),fe(r,"click",pt(e[18])),fe(k,"click",B),fe(t,"click",J)],x=!0)},p(S,O){if(e=S,O[0]&64&&n!==(n=e[44]+1+"")&&me(a,n),O[0]&4){T=Ce(e[2]);let A;for(A=0;A<T.length;A+=1){const te=rt(e,T,A);g[A]?g[A].p(te,O):(g[A]=ft(te),g[A].c(),g[A].m(r,null))}for(;A<g.length;A+=1)g[A].d(1);g.length=T.length}O[0]&68&&D!==(D=e[42].class_id)&&Ae(r,e[42].class_id),P===(P=ee(e))&&I?I.p(e,O):(I.d(1),I=P(e),I&&(I.c(),I.m(p,null))),O[0]&64&&j!==(j=(e[42].source||"manual")+"")&&me(N,j),O[0]&64&&he(F,"badge-info",e[42].source==="auto"),O[0]&64&&he(F,"badge-ghost",e[42].source!=="auto"),O[0]&96&&he(t,"bg-primary",e[5]===e[42].rect),O[0]&96&&he(t,"bg-opacity-20",e[5]===e[42].rect)},d(S){S&&v(t),Ne(g,S),I.d(),x=!1,xe(u)}}}function ht(s){let e,t,l,n=s[6].length+"",a,i,c,r,D="Click row to select, change class from dropdown";return{c(){e=_("div"),t=_("span"),l=Q("Total: "),a=Q(n),i=Q(" label(s)"),c=z(),r=_("span"),r.textContent=D,this.h()},l(m){e=h(m,"DIV",{class:!0});var p=w(e);t=h(p,"SPAN",{});var E=w(t);l=K(E,"Total: "),a=K(E,n),i=K(E," label(s)"),E.forEach(v),c=R(p),r=h(p,"SPAN",{class:!0,"data-svelte-h":!0}),se(r)!=="svelte-1ss4u1m"&&(r.textContent=D),p.forEach(v),this.h()},h(){f(r,"class","opacity-70"),f(e,"class","px-3 py-2 bg-base-200 text-xs flex justify-between")},m(m,p){le(m,e,p),o(e,t),o(t,l),o(t,a),o(t,i),o(e,c),o(e,r)},p(m,p){p[0]&64&&n!==(n=m[6].length+"")&&me(a,n)},d(m){m&&v(e)}}}function jt(s){let e,t,l,n,a="New Class:",i,c,r,D,m,p="Conf:",E,V,F,j,N=Math.round(s[4]*100)+"",y,b,k,q,W,x,u="Auto Label",T,g,X,ee,P,I,B="Clear All",J,S,O="Save",A,te,ie,ne,re,U,Y,ae,ge='<tr><th class="w-8">#</th> <th>Class</th> <th>Confidence</th> <th>Source</th> <th class="w-24">Actions</th></tr>',ve,pe,d=[],C=new Map,G,M,ue,ce=Ce(s[2]),Z=[];for(let H=0;H<ce.length;H+=1)Z[H]=ct(it(s,ce,H));let be=Ce(s[6]);const Ie=H=>H[42].index;for(let H=0;H<be.length;H+=1){let $=ot(s,be,H),L=Ie($);C.set(L,d[H]=ut(L,$))}let oe=null;be.length||(oe=dt());let de=s[6].length>0&&ht(s);return{c(){e=_("div"),t=_("div"),l=_("div"),n=_("span"),n.textContent=a,i=z(),c=_("select");for(let H=0;H<Z.length;H+=1)Z[H].c();r=z(),D=_("div"),m=_("span"),m.textContent=p,E=z(),V=_("input"),F=z(),j=_("span"),y=Q(N),b=Q("%"),k=z(),q=_("div"),W=z(),x=_("button"),x.textContent=u,T=z(),g=_("button"),X=Q("Delete"),P=z(),I=_("button"),I.textContent=B,J=z(),S=_("button"),S.textContent=O,A=z(),te=_("div"),ie=_("canvas"),ne=z(),re=_("div"),U=_("div"),Y=_("table"),ae=_("thead"),ae.innerHTML=ge,ve=z(),pe=_("tbody");for(let H=0;H<d.length;H+=1)d[H].c();oe&&oe.c(),G=z(),de&&de.c(),this.h()},l(H){e=h(H,"DIV",{class:!0});var $=w(e);t=h($,"DIV",{class:!0});var L=w(t);l=h(L,"DIV",{class:!0});var Ee=w(l);n=h(Ee,"SPAN",{class:!0,"data-svelte-h":!0}),se(n)!=="svelte-1j9ugz0"&&(n.textContent=a),i=R(Ee),c=h(Ee,"SELECT",{class:!0});var We=w(c);for(let ye=0;ye<Z.length;ye+=1)Z[ye].l(We);We.forEach(v),Ee.forEach(v),r=R(L),D=h(L,"DIV",{class:!0});var Ve=w(D);m=h(Ve,"SPAN",{class:!0,"data-svelte-h":!0}),se(m)!=="svelte-1psb6sb"&&(m.textContent=p),E=R(Ve),V=h(Ve,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),F=R(Ve),j=h(Ve,"SPAN",{class:!0});var Me=w(j);y=K(Me,N),b=K(Me,"%"),Me.forEach(v),Ve.forEach(v),k=R(L),q=h(L,"DIV",{class:!0}),w(q).forEach(v),W=R(L),x=h(L,"BUTTON",{class:!0,"data-svelte-h":!0}),se(x)!=="svelte-179nf9h"&&(x.textContent=u),T=R(L),g=h(L,"BUTTON",{class:!0});var qe=w(g);X=K(qe,"Delete"),qe.forEach(v),P=R(L),I=h(L,"BUTTON",{class:!0,"data-svelte-h":!0}),se(I)!=="svelte-nobjql"&&(I.textContent=B),J=R(L),S=h(L,"BUTTON",{class:!0,"data-svelte-h":!0}),se(S)!=="svelte-1plmalh"&&(S.textContent=O),L.forEach(v),A=R($),te=h($,"DIV",{class:!0});var Ye=w(te);ie=h(Ye,"CANVAS",{}),w(ie).forEach(v),Ye.forEach(v),ne=R($),re=h($,"DIV",{class:!0});var Fe=w(re);U=h(Fe,"DIV",{class:!0});var Xe=w(U);Y=h(Xe,"TABLE",{class:!0});var Se=w(Y);ae=h(Se,"THEAD",{class:!0,"data-svelte-h":!0}),se(ae)!=="svelte-149n8qj"&&(ae.innerHTML=ge),ve=R(Se),pe=h(Se,"TBODY",{});var Le=w(pe);for(let ye=0;ye<d.length;ye+=1)d[ye].l(Le);oe&&oe.l(Le),Le.forEach(v),Se.forEach(v),Xe.forEach(v),G=R(Fe),de&&de.l(Fe),Fe.forEach(v),$.forEach(v),this.h()},h(){f(n,"class","join-item btn btn-sm no-animation"),f(c,"class","select select-bordered select-sm join-item"),s[3]===void 0&&vt(()=>s[19].call(c)),f(l,"class","join"),f(m,"class","text-xs opacity-70"),f(V,"type","range"),f(V,"min","0.1"),f(V,"max","0.9"),f(V,"step","0.05"),f(V,"class","range range-xs range-primary w-20"),f(j,"class","text-xs font-mono w-8"),f(D,"class","flex items-center gap-2 bg-base-100 px-3 py-1 rounded-lg"),f(q,"class","flex-1"),f(x,"class","btn btn-primary btn-sm"),f(g,"class","btn btn-error btn-sm"),g.disabled=ee=!s[5],f(I,"class","btn btn-warning btn-sm"),f(S,"class","btn btn-success btn-sm"),f(t,"class","flex flex-wrap gap-2 items-center"),f(te,"class","flex-1 flex items-center justify-center bg-base-300 rounded-lg overflow-hidden min-h-[250px]"),f(ae,"class","sticky top-0 bg-base-200 z-10"),f(Y,"class","table table-xs table-zebra w-full"),f(U,"class","overflow-x-auto max-h-48"),f(re,"class","bg-base-100 rounded-lg overflow-hidden"),f(e,"class","flex flex-col h-full gap-3")},m(H,$){le(H,e,$),o(e,t),o(t,l),o(l,n),o(l,i),o(l,c);for(let L=0;L<Z.length;L+=1)Z[L]&&Z[L].m(c,null);Ae(c,s[3],!0),o(t,r),o(t,D),o(D,m),o(D,E),o(D,V),we(V,s[4]),o(D,F),o(D,j),o(j,y),o(j,b),o(t,k),o(t,q),o(t,W),o(t,x),o(t,T),o(t,g),o(g,X),o(t,P),o(t,I),o(t,J),o(t,S),o(e,A),o(e,te),o(te,ie),s[21](ie),o(e,ne),o(e,re),o(re,U),o(U,Y),o(Y,ae),o(Y,ve),o(Y,pe);for(let L=0;L<d.length;L+=1)d[L]&&d[L].m(pe,null);oe&&oe.m(pe,null),o(re,G),de&&de.m(re,null),s[25](e),M||(ue=[fe(c,"change",s[19]),fe(V,"change",s[20]),fe(V,"input",s[20]),fe(x,"click",s[7]),fe(g,"click",s[9]),fe(I,"click",s[10]),fe(S,"click",s[8])],M=!0)},p(H,$){if($[0]&4){ce=Ce(H[2]);let L;for(L=0;L<ce.length;L+=1){const Ee=it(H,ce,L);Z[L]?Z[L].p(Ee,$):(Z[L]=ct(Ee),Z[L].c(),Z[L].m(c,null))}for(;L<Z.length;L+=1)Z[L].d(1);Z.length=ce.length}$[0]&12&&Ae(c,H[3]),$[0]&16&&we(V,H[4]),$[0]&16&&N!==(N=Math.round(H[4]*100)+"")&&me(y,N),$[0]&32&&ee!==(ee=!H[5])&&(g.disabled=ee),$[0]&14436&&(be=Ce(H[6]),d=kt(d,$,Ie,1,H,be,C,pe,Ct,ut,null,ot),!be.length&&oe?oe.p(H,$):be.length?oe&&(oe.d(1),oe=null):(oe=dt(),oe.c(),oe.m(pe,null))),H[6].length>0?de?de.p(H,$):(de=ht(H),de.c(),de.m(re,null)):de&&(de.d(1),de=null)},i:_e,o:_e,d(H){H&&v(e),Ne(Z,H),s[21](null);for(let $=0;$<d.length;$+=1)d[$].d();oe&&oe.d(),de&&de.d(),s[25](null),M=!1,xe(ue)}}}function Nt(s,e,t){let{frame:l=null}=e,{videoId:n=""}=e;const a=He();let i,c,r,D=[],m=0,p=.35,E=!1,V,F,j,N=null,y=[];const b=["#FF0000","#0000FF","#FFFF00","#00FF00","#800080","#FFA500","#00FFFF","#8B4513","#CCCCCC","#FFC0CB","#32CD32","#FFD700"];_t(async()=>{if(window.fabric)k();else{const d=document.createElement("script");d.src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js",d.onload=k,document.head.appendChild(d)}try{const d=await fetch("/api/classes");t(2,D=await d.json())}catch(d){console.error("Failed to load classes:",d)}}),mt(()=>{r&&r.dispose()});function k(){t(16,r=new fabric.Canvas(c,{selection:!1})),r.on("mouse:down",X),r.on("mouse:move",ee),r.on("mouse:up",P),r.on("selection:created",T),r.on("selection:updated",T),r.on("selection:cleared",()=>{t(5,N=null)}),r.on("object:modified",u),r.on("object:moving",g),r.on("object:scaling",g),l&&W()}let q=null;function W(){!r||!l||(r.clear(),t(5,N=null),t(6,y=[]),fabric.Image.fromURL(`/api/frames/${n}/${l.frame_id}/image`,d=>{const C=i.clientWidth,G=i.clientHeight-280,M=Math.min(C/d.width,G/d.height,1);r.setWidth(d.width*M),r.setHeight(d.height*M),r.setBackgroundImage(d,r.renderAll.bind(r),{scaleX:M,scaleY:M}),l.labels&&l.labels.forEach(ue=>{x(ue)}),u()},{crossOrigin:"anonymous"}))}function x(d){const C=r.getWidth(),G=r.getHeight(),M=(d.x_center-d.width/2)*C,ue=(d.y_center-d.height/2)*G,ce=d.width*C,Z=d.height*G,be=b[d.class_id]||"#FF0000",Ie=d.confidence?` ${Math.round(d.confidence*100)}%`:"",oe=new fabric.Text(`${d.class_name}${Ie}`,{left:M,top:ue-16,fontSize:12,fill:"#fff",backgroundColor:be,padding:2,selectable:!1,evented:!1}),de=new fabric.Rect({left:M,top:ue,width:ce,height:Z,fill:"transparent",stroke:be,strokeWidth:2,selectable:!0,hasControls:!0,cornerColor:be,cornerSize:8,transparentCorners:!1,labelData:{...d},labelText:oe});r.add(oe),r.add(de)}function u(){if(!r)return;const d=[];r.getObjects("rect").forEach((G,M)=>{G.labelData&&d.push({index:M,...G.labelData,rect:G})}),t(6,y=d)}function T(d){var G;const C=(G=d.selected)==null?void 0:G[0];C&&C.type==="rect"&&C.labelData&&(t(5,N=C),t(3,m=C.labelData.class_id)),u()}function g(d){const C=d.target;C&&C.type==="rect"&&C.labelText&&(C.labelText.set({left:C.left,top:C.top-16}),r.renderAll())}function X(d){if(d.target)return;E=!0;const C=r.getPointer(d.e);V=C.x,F=C.y,j=new fabric.Rect({left:V,top:F,width:0,height:0,fill:"transparent",stroke:b[m],strokeWidth:2,selectable:!1}),r.add(j)}function ee(d){if(!E||!j)return;const C=r.getPointer(d.e),G=C.x-V,M=C.y-F;j.set({width:Math.abs(G),height:Math.abs(M),left:G<0?C.x:V,top:M<0?C.y:F}),r.renderAll()}function P(){var M;if(!E||!j)return;if(E=!1,j.width<10||j.height<10){r.remove(j),j=null;return}const d=((M=D[m])==null?void 0:M.class_name)||`class_${m}`,C=b[m],G=new fabric.Text(d,{left:j.left,top:j.top-16,fontSize:12,fill:"#fff",backgroundColor:C,padding:2,selectable:!1,evented:!1});j.set({selectable:!0,hasControls:!0,cornerColor:C,cornerSize:8,transparentCorners:!1,labelData:{class_id:m,class_name:d,confidence:null,source:"manual"},labelText:G}),r.add(G),r.renderAll(),j=null,u()}function I(){const d=[],C=r.getWidth(),G=r.getHeight();return r.getObjects("rect").forEach(M=>{if(!M.labelData)return;const ue=M.scaleX||1,ce=M.scaleY||1,Z=(M.left+M.width*ue/2)/C,be=(M.top+M.height*ce/2)/G,Ie=M.width*ue/C,oe=M.height*ce/G;d.push({class_id:M.labelData.class_id,class_name:M.labelData.class_name,x_center:Z,y_center:be,width:Ie,height:oe,confidence:M.labelData.confidence,source:M.labelData.source||"manual"})}),d}async function B(){try{await fetch(`/api/frames/${n}/${l.frame_id}/auto-label`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confidence_threshold:p})});const C=await(await fetch(`/api/frames/${n}/${l.frame_id}`)).json();t(17,q=null),t(14,l=C),a("update")}catch(d){console.error("Auto-label failed:",d)}}async function J(){const d=I();try{await fetch(`/api/frames/${n}/${l.frame_id}/labels`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({labels:d})});const G=await(await fetch(`/api/frames/${n}/${l.frame_id}`)).json();t(17,q=null),t(14,l=G),a("update")}catch(C){console.error("Save failed:",C)}}function S(){N&&(N.labelText&&r.remove(N.labelText),r.remove(N),t(5,N=null),r.renderAll(),u())}function O(){confirm("Clear all bounding boxes?")&&(r.getObjects("rect").forEach(C=>{C.labelText&&r.remove(C.labelText),r.remove(C)}),t(5,N=null),r.renderAll(),u())}function A(d){d.rect&&(r.setActiveObject(d.rect),r.renderAll(),t(5,N=d.rect),t(3,m=d.class_id))}function te(d,C){C.stopPropagation(),d.rect&&(d.rect.labelText&&r.remove(d.rect.labelText),r.remove(d.rect),N===d.rect&&t(5,N=null),r.renderAll(),u())}function ie(d,C,G){if(G.stopPropagation(),d.rect&&d.rect.labelData){const M=D[C],ue=(M==null?void 0:M.class_name)||`class_${C}`,ce=b[C];if(d.rect.labelData.class_id=C,d.rect.labelData.class_name=ue,d.rect.set({stroke:ce,cornerColor:ce}),d.rect.labelText){const Z=d.rect.labelData.confidence?` ${Math.round(d.rect.labelData.confidence*100)}%`:"";d.rect.labelText.set({text:`${ue}${Z}`,backgroundColor:ce})}r.renderAll(),u()}}function ne(d){bt.call(this,s,d)}function re(){m=gt(this),t(3,m),t(2,D)}function U(){p=wt(this.value),t(4,p)}function Y(d){Ge[d?"unshift":"push"](()=>{c=d,t(1,c)})}const ae=(d,C)=>ie(d,parseInt(C.target.value),C),ge=(d,C)=>te(d,C),ve=d=>A(d);function pe(d){Ge[d?"unshift":"push"](()=>{i=d,t(0,i)})}return s.$$set=d=>{"frame"in d&&t(14,l=d.frame),"videoId"in d&&t(15,n=d.videoId)},s.$$.update=()=>{s.$$.dirty[0]&212992&&l&&r&&l.frame_id!==q&&(t(17,q=l.frame_id),W())},[i,c,D,m,p,N,y,B,J,S,O,A,te,ie,l,n,r,q,ne,re,U,Y,ae,ge,ve,pe]}class Pt extends Pe{constructor(e){super(),Oe(this,e,Nt,jt,je,{frame:14,videoId:15},null,[-1,-1])}}function Ot(s){let e,t='<div class="card-body items-center justify-center"><p class="text-base-content/50">Select a video to view frames</p></div>';return{c(){e=_("div"),e.innerHTML=t,this.h()},l(l){e=h(l,"DIV",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-1cgu05p"&&(e.innerHTML=t),this.h()},h(){f(e,"class","card bg-base-200 shadow-xl flex-1")},m(l,n){le(l,e,n)},p:_e,i:_e,o:_e,d(l){l&&v(e)}}}function Mt(s){let e,t,l,n,a,i="5 sec",c,r="10 sec",D,m="15 sec",p,E="30 sec",V,F,j="Extract Frames",N,y,b,k,q,W=s[2].length+"",x,u,T,g,X,ee,P,I;return X=new Ft({props:{frames:s[2],selectedFrame:s[3],videoId:s[1].video_id}}),X.$on("select",s[11]),{c(){e=_("div"),t=_("div"),l=_("div"),n=_("select"),a=_("option"),a.textContent=i,c=_("option"),c.textContent=r,D=_("option"),D.textContent=m,p=_("option"),p.textContent=E,V=z(),F=_("button"),F.textContent=j,N=z(),y=_("div"),b=_("div"),k=_("h2"),q=Q("Frames ("),x=Q(W),u=Q(")"),T=z(),g=_("div"),ze(X.$$.fragment),this.h()},l(B){e=h(B,"DIV",{class:!0});var J=w(e);t=h(J,"DIV",{class:!0});var S=w(t);l=h(S,"DIV",{class:!0});var O=w(l);n=h(O,"SELECT",{id:!0,class:!0});var A=w(n);a=h(A,"OPTION",{"data-svelte-h":!0}),se(a)!=="svelte-194rc23"&&(a.textContent=i),c=h(A,"OPTION",{"data-svelte-h":!0}),se(c)!=="svelte-1t2yoiw"&&(c.textContent=r),D=h(A,"OPTION",{"data-svelte-h":!0}),se(D)!=="svelte-13i6z85"&&(D.textContent=m),p=h(A,"OPTION",{"data-svelte-h":!0}),se(p)!=="svelte-1lapxut"&&(p.textContent=E),A.forEach(v),V=R(O),F=h(O,"BUTTON",{class:!0,"data-svelte-h":!0}),se(F)!=="svelte-1y3x4tz"&&(F.textContent=j),O.forEach(v),S.forEach(v),J.forEach(v),N=R(B),y=h(B,"DIV",{class:!0});var te=w(y);b=h(te,"DIV",{class:!0});var ie=w(b);k=h(ie,"H2",{class:!0});var ne=w(k);q=K(ne,"Frames ("),x=K(ne,W),u=K(ne,")"),ne.forEach(v),T=R(ie),g=h(ie,"DIV",{class:!0});var re=w(g);Re(X.$$.fragment,re),re.forEach(v),ie.forEach(v),te.forEach(v),this.h()},h(){a.__value="5",we(a,a.__value),c.__value="10",we(c,c.__value),c.selected=!0,D.__value="15",we(D,D.__value),p.__value="30",we(p,p.__value),f(n,"id","extract-interval"),f(n,"class","select select-bordered select-sm flex-1"),f(F,"class","btn btn-primary btn-sm"),f(l,"class","flex gap-2 items-center"),f(t,"class","card-body p-4"),f(e,"class","card bg-base-200 shadow-xl"),f(k,"class","card-title text-sm"),f(g,"class","overflow-y-auto flex-1"),f(b,"class","card-body p-4"),f(y,"class","card bg-base-200 shadow-xl flex-1 overflow-hidden")},m(B,J){le(B,e,J),o(e,t),o(t,l),o(l,n),o(n,a),o(n,c),o(n,D),o(n,p),o(l,V),o(l,F),le(B,N,J),le(B,y,J),o(y,b),o(b,k),o(k,q),o(k,x),o(k,u),o(b,T),o(b,g),Ue(X,g,null),ee=!0,P||(I=fe(F,"click",s[8]),P=!0)},p(B,J){(!ee||J&4)&&W!==(W=B[2].length+"")&&me(x,W);const S={};J&4&&(S.frames=B[2]),J&8&&(S.selectedFrame=B[3]),J&2&&(S.videoId=B[1].video_id),X.$set(S)},i(B){ee||(ke(X.$$.fragment,B),ee=!0)},o(B){Te(X.$$.fragment,B),ee=!1},d(B){B&&(v(e),v(N),v(y)),Be(X),P=!1,I()}}}function Lt(s){let e,t='<p class="text-base-content/50">Select a frame to start labeling</p>';return{c(){e=_("div"),e.innerHTML=t,this.h()},l(l){e=h(l,"DIV",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-1ysb5l2"&&(e.innerHTML=t),this.h()},h(){f(e,"class","flex items-center justify-center h-full")},m(l,n){le(l,e,n)},p:_e,i:_e,o:_e,d(l){l&&v(e)}}}function Ht(s){let e,t;return e=new Pt({props:{frame:s[3],videoId:s[1].video_id}}),e.$on("update",s[9]),{c(){ze(e.$$.fragment)},l(l){Re(e.$$.fragment,l)},m(l,n){Ue(e,l,n),t=!0},p(l,n){const a={};n&8&&(a.frame=l[3]),n&2&&(a.videoId=l[1].video_id),e.$set(a)},i(l){t||(ke(e.$$.fragment,l),t=!0)},o(l){Te(e.$$.fragment,l),t=!1},d(l){Be(e,l)}}}function Bt(s){let e,t,l,n,a,i="Upload Videos",c,r,D,m,p,E,V,F=s[0].length+"",j,N,y,b,k,q,W,x,u,T,g,X,ee,P,I,B,J,S;k=new Dt({props:{videos:s[0],selectedVideo:s[1]}}),k.$on("select",s[10]),k.$on("refresh",s[4]);const O=[Mt,Ot],A=[];function te(U,Y){return U[1]?0:1}x=te(s),u=A[x]=O[x](s);const ie=[Ht,Lt],ne=[];function re(U,Y){return U[3]?0:1}return P=re(s),I=ne[P]=ie[P](s),{c(){e=_("div"),t=_("div"),l=_("div"),n=_("div"),a=_("h2"),a.textContent=i,c=z(),r=_("input"),D=z(),m=_("div"),p=_("div"),E=_("h2"),V=Q("Videos ("),j=Q(F),N=Q(")"),y=z(),b=_("div"),ze(k.$$.fragment),q=z(),W=_("div"),u.c(),T=z(),g=_("div"),X=_("div"),ee=_("div"),I.c(),this.h()},l(U){e=h(U,"DIV",{class:!0});var Y=w(e);t=h(Y,"DIV",{class:!0});var ae=w(t);l=h(ae,"DIV",{class:!0});var ge=w(l);n=h(ge,"DIV",{class:!0});var ve=w(n);a=h(ve,"H2",{class:!0,"data-svelte-h":!0}),se(a)!=="svelte-1kfecm3"&&(a.textContent=i),c=R(ve),r=h(ve,"INPUT",{type:!0,accept:!0,class:!0}),ve.forEach(v),ge.forEach(v),D=R(ae),m=h(ae,"DIV",{class:!0});var pe=w(m);p=h(pe,"DIV",{class:!0});var d=w(p);E=h(d,"H2",{class:!0});var C=w(E);V=K(C,"Videos ("),j=K(C,F),N=K(C,")"),C.forEach(v),y=R(d),b=h(d,"DIV",{class:!0});var G=w(b);Re(k.$$.fragment,G),G.forEach(v),d.forEach(v),pe.forEach(v),ae.forEach(v),q=R(Y),W=h(Y,"DIV",{class:!0});var M=w(W);u.l(M),M.forEach(v),T=R(Y),g=h(Y,"DIV",{class:!0});var ue=w(g);X=h(ue,"DIV",{class:!0});var ce=w(X);ee=h(ce,"DIV",{class:!0});var Z=w(ee);I.l(Z),Z.forEach(v),ce.forEach(v),ue.forEach(v),Y.forEach(v),this.h()},h(){f(a,"class","card-title text-sm"),f(r,"type","file"),f(r,"accept",".avi,.mp4,.mov,.mkv,.wmv"),r.multiple=!0,f(r,"class","file-input file-input-bordered file-input-sm w-full"),f(n,"class","card-body p-4"),f(l,"class","card bg-base-200 shadow-xl"),f(E,"class","card-title text-sm"),f(b,"class","overflow-y-auto flex-1"),f(p,"class","card-body p-4"),f(m,"class","card bg-base-200 shadow-xl flex-1 overflow-hidden"),f(t,"class","col-span-3 flex flex-col gap-4"),f(W,"class","col-span-3 flex flex-col gap-4"),f(ee,"class","card-body p-4"),f(X,"class","card bg-base-200 shadow-xl h-full"),f(g,"class","col-span-6"),f(e,"class","grid grid-cols-12 gap-4 h-[calc(100vh-140px)]")},m(U,Y){le(U,e,Y),o(e,t),o(t,l),o(l,n),o(n,a),o(n,c),o(n,r),o(t,D),o(t,m),o(m,p),o(p,E),o(E,V),o(E,j),o(E,N),o(p,y),o(p,b),Ue(k,b,null),o(e,q),o(e,W),A[x].m(W,null),o(e,T),o(e,g),o(g,X),o(X,ee),ne[P].m(ee,null),B=!0,J||(S=fe(r,"change",s[7]),J=!0)},p(U,[Y]){(!B||Y&1)&&F!==(F=U[0].length+"")&&me(j,F);const ae={};Y&1&&(ae.videos=U[0]),Y&2&&(ae.selectedVideo=U[1]),k.$set(ae);let ge=x;x=te(U),x===ge?A[x].p(U,Y):(Qe(),Te(A[ge],1,1,()=>{A[ge]=null}),Ke(),u=A[x],u?u.p(U,Y):(u=A[x]=O[x](U),u.c()),ke(u,1),u.m(W,null));let ve=P;P=re(U),P===ve?ne[P].p(U,Y):(Qe(),Te(ne[ve],1,1,()=>{ne[ve]=null}),Ke(),I=ne[P],I?I.p(U,Y):(I=ne[P]=ie[P](U),I.c()),ke(I,1),I.m(ee,null))},i(U){B||(ke(k.$$.fragment,U),ke(u),ke(I),B=!0)},o(U){Te(k.$$.fragment,U),Te(u),Te(I),B=!1},d(U){U&&v(e),Be(k),A[x].d(),ne[P].d(),J=!1,S()}}}const De="/api";function Ut(s,e,t){let l=[],n=null,a=[],i=null,c={total_videos:0,total_frames:0,approved_frames:0};_t(async()=>{await r(),await D()});async function r(){try{const y=await fetch(`${De}/videos`);t(0,l=await y.json())}catch(y){console.error("Failed to load videos:",y)}}async function D(){try{c=await(await fetch(`${De}/stats`)).json(),document.getElementById("stat-videos").textContent=c.total_videos,document.getElementById("stat-frames").textContent=c.total_frames,document.getElementById("stat-labeled").textContent=c.approved_frames}catch(y){console.error("Failed to load stats:",y)}}async function m(y){t(1,n=y),t(3,i=null);try{const k=await(await fetch(`${De}/videos/${y.video_id}/frames`)).json();t(2,a=k.frames||[])}catch(b){console.error("Failed to load frames:",b),t(2,a=[])}}async function p(y){try{const b=await fetch(`${De}/frames/${n.video_id}/${y.frame_id}`);t(3,i=await b.json())}catch(b){console.error("Failed to load frame:",b)}}async function E(y){const b=y.target.files;if(b.length){for(const k of b){const q=new FormData;q.append("file",k);try{await fetch(`${De}/videos/upload`,{method:"POST",body:q})}catch(W){console.error("Upload failed:",W)}}await r(),await D(),y.target.value=""}}async function V(){if(!n)return;const y=document.getElementById("extract-interval").value;try{const k=await(await fetch(`${De}/videos/${n.video_id}/extract`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({frame_interval:parseInt(y)})})).json();alert(`Extracted ${k.frames_extracted} frames`),await m(n),await D()}catch(b){console.error("Extract failed:",b)}}async function F(){if(n){const b=await(await fetch(`${De}/videos/${n.video_id}/frames`)).json();t(2,a=b.frames||[])}D()}return[l,n,a,i,r,m,p,E,V,F,y=>m(y.detail),y=>p(y.detail)]}class Wt extends Pe{constructor(e){super(),Oe(this,e,Ut,Bt,je,{})}}export{Wt as component};
